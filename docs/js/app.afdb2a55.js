(function(){"use strict";var e={8987:function(e,t,r){var n=r(9242),o=r(3396);function s(e,t,r,n,s,a){const i=(0,o.up)("SalesRank");return(0,o.wg)(),(0,o.j4)(i,{data_root:"https://aeroblast.github.io/book_sales_info_data/"})}const a={class:"sales_rank"},i=(0,o._)("option",{value:"sales"},"部数",-1),l=(0,o._)("option",{value:"date"},"日付",-1),u=[i,l];function c(e,t,r,s,i,l){const c=(0,o.up)("RankEntry");return(0,o.wg)(),(0,o.iD)("div",a,[(0,o.wy)((0,o._)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.sort_method=e),onChange:t[1]||(t[1]=e=>l.SortEntries())},u,544),[[n.bM,i.sort_method]]),(0,o._)("div",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.entries,(e=>((0,o.wg)(),(0,o.j4)(c,{entry:e,key:e.isbn},null,8,["entry"])))),128))])])}const d="https://aeroblast.github.io/book_sales_info_data/";var p=r(7139);const f={class:"editor"},h=["data-editor"],_=["data-editor"],g=(0,o._)("br",null,null,-1),m=(0,o._)("br",null,null,-1),v=(0,o._)("br",null,null,-1),y=(0,o._)("br",null,null,-1),b={class:"desc_preview"},w=["innerHTML"],D=["data-detail"],k={class:"salesValue"},S=["innerHTML"],O={class:"date"},C=["data-detail"],T={key:0},j=["href"];function U(e,t,r,s,a,i){const l=(0,o.up)("MarkDown");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",f,[(0,o._)("span",{class:"trigger",onClick:t[0]||(t[0]=e=>{a.editor=!a.editor,a.detail=a.editor}),title:"更新用JSON"}),(0,o._)("span",{class:"editor_title","data-editor":a.editor},"更新用JSONを生成",8,h),(0,o._)("div",{class:"editor_area","data-editor":a.editor},[(0,o.Uk)(" 部数詳細："),(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>a.editor_salesDesc=e)},null,512),[[n.nr,a.editor_salesDesc]]),(0,o._)("span",null,(0,p.zw)(i.SearchAsianNumber(a.editor_salesDesc)),1),g,(0,o.Uk)(" 　　日付："),(0,o.wy)((0,o._)("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=e=>a.editor_date=e)},null,512),[[n.nr,a.editor_date]]),m,(0,o.Uk)(" 情報元(MarkDown)："),v,(0,o.wy)((0,o._)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>a.editor_sourceDesc=e)},"[]()",512),[[n.nr,a.editor_sourceDesc]]),y,(0,o.Uk)(" 情報元(Preview)： "),(0,o._)("div",b,[(0,o.Wm)(l,{raw:a.editor_sourceDesc},null,8,["raw"])]),(0,o._)("button",{onClick:t[4]||(t[4]=(...e)=>i.TryCopy&&i.TryCopy(...e))},"Copy"),(0,o._)("span",{innerHTML:a.copy_result},null,8,w)],8,_)]),(0,o._)("div",{class:"entry","data-detail":a.detail},[(0,o._)("span",k,(0,p.zw)(i.AsianNumber(r.entry.salesValue))+"部",1),(0,o.Uk)("   "),(0,o._)("span",{class:"title",onClick:t[5]||(t[5]=e=>a.detail=!a.detail),innerHTML:i.titleDisplayHTML},null,8,S),(0,o.Uk)("   "),(0,o._)("span",O,(0,p.zw)(r.entry.recordDate),1)],8,D),(0,o._)("div",{class:"detail","data-detail":a.detail},[i.isLongTitle?((0,o.wg)(),(0,o.iD)("p",T,"タイトル："+(0,p.zw)(r.entry.title),1)):(0,o.kq)("",!0),(0,o._)("p",null,"部数詳細："+(0,p.zw)(r.entry.salesDesc),1),(0,o._)("p",null,[(0,o.Wm)(l,{raw:"　情報元："+r.entry.sourceDesc},null,8,["raw"])]),(0,o._)("p",null,[(0,o.Uk)("　　紹介："),(0,o._)("a",{target:"_blank",href:"https://www.amazon.co.jp/dp/"+r.entry.isbn},"Amazon",8,j)])],8,C)],64)}r(7658);const A=["href"],$=["src","title"],M=["data-large"],x=["src"];function E(e,t,r,n,s,a){return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("a",{target:"_blank",href:a.absoluteSrc},(0,p.zw)(r.title),9,A),(0,o._)("img",{class:"inline",onClick:t[0]||(t[0]=e=>s.large=!s.large),src:a.absoluteSrc,title:r.title},null,8,$),(0,o._)("div",{"data-large":s.large},[(0,o._)("img",{src:a.absoluteSrc,onClick:t[1]||(t[1]=e=>s.large=!s.large)},null,8,x)],8,M)],64)}var I={name:"InlineImage",props:{title:String,src:String},mounted(){},data(){return{large:!1}},methods:{},computed:{absoluteSrc(){return this.src.startsWith("images/")?d+this.src:this.src}}},z=r(89);const V=(0,z.Z)(I,[["render",E],["__scopeId","data-v-1baeaf49"]]);var H=V,L={name:"MarkDown",props:{raw:String},render(){const e=this.Compile(this.raw),t=R(e);return t},methods:{Compile(e){let t=e.replaceAll(/!\[(.*?)\]\((.+?)\)/g,((e,t,r)=>`<InlineImage title="${t}" src="${r}"/>`));return t=t.replace(/\[(.+?)\]\((.+?)\)/g,"<a href='$2'>$1</a>"),t}},computed:{}};const N=/<([a-zA-Z0-9/].*?)>/g;function R(e){let t=e.matchAll(N),r=0,n=[];for(const s of t){const t=e.substring(r,s.index);t&&n.push(t);const o=F(s[1]);n.push(o),r=s.index+s[0].length}{const t=e.substring(r);t&&n.push(t)}let o=[];return Z(n,0,o),o}function Z(e,t,r){for(;t<e.length;){const n=e[t];if("string"===typeof n)r.push(n),t++;else switch(n.info){case"opening":{let o=[];t=Z(e,t+1,o),1==o.length&&"string"===typeof o[0]&&(o=o[0]),r.push(n.value(o))}break;case"void":r.push(n.value()),t++;break;case"closing":return t+1;default:throw console.error(n.value),n.info}}}function F(e){const t={a:{attr:["href"],form:"opening",v(e,t){return e.target="_blank",(0,o.h)("a",e,t)}},InlineImage:{attr:["title","src"],form:"void",v(e){return(0,o.h)(H,e)}}};if("/"==e[0]){let r=e.substring(1);return r in t?"opening"===t[r].form?{info:"closing",value:r}:{info:"error",value:"ForbiddenClosing: "+r}:{info:"error",value:"UnsupportedClosing: "+r}}let r="opening";"/"==e[e.length-1]&&(e=e.substring(0,e.length-1),r="void");let n=e.indexOf(" ");if(n<0){if(e in t){let n=t[e];return n.form===r?{info:r,value:()=>n.v({})}:{info:"error",value:`Unsupported:${r} of ${e}`}}return{info:"error",value:`UnsupportedTag: ${e}`}}{const o=e.substring(0,n);if(o in t){let s=t[o],a=P(e.substring(n).trim());return{info:r,value:e=>s.v(a,e)}}return{info:"error",value:`UnsupportedTag: ${o}`}}}const J=/([a-zA-Z0-9-_]+)=(["'])(.*?)(["'])/g;function P(e){let t=e.matchAll(J),r={};for(const n of t){if(n[2]!=n[4])return console.error("ReadAttrs Fail: "+e),{};r[n[1]]=n[3]}return r}const W=L;var Y=W,q={name:"RankEntry",props:{entry:Object},components:{MarkDown:Y},data(){return{detail:!1,editor:!1,editor_salesDesc:"",editor_sourceDesc:"[]()",editor_date:null,copy_result:""}},mounted(){},methods:{AsianNumber(e){let t=e%1e4;if(0==t)return e/1e4+"万";let r=t%1e3;return 0==r?`${Math.floor(e/1e4)}万${t/1e3}千`:`${e/1e4}万${t}`},SearchAsianNumber(e){let t=e.match(/([0-9]+)万(([0-9]+)千)?/);if(!t)return 0;let r=0;return t[3]&&(r+=1e3*parseInt(t[3])),t[1]&&(r+=1e4*parseInt(t[1])),r},TryCopy(){let e={};if(e.salesDesc=this.editor_salesDesc.trim(),!e.salesDesc)return void(this.copy_result="Error: SalesDesc is empty!");if(e.recordDate=this.editor_date,!e.recordDate)return void(this.copy_result="Error: recordDate is empty!");if(e.recordDate.localeCompare(this.entry.recordDate)<=0)return void(this.copy_result="Error: New date should not earlier than last record!");if(e.sourceDesc=this.editor_sourceDesc.trim(),!e.sourceDesc)return void(this.copy_result="Error: SourceDesc is empty!");e.salesValue=this.SearchAsianNumber(e.salesDesc),e.isbn=this.entry.isbn,e.title=this.entry.title;let t=JSON.stringify(e,["title","salesValue","recordDate","salesDesc","sourceDesc","isbn"],2).replaceAll("\n","\n  ");console.log(t),navigator.clipboard.writeText(t).then((()=>{this.copy_result="Success!"}))}},computed:{isLongTitle(){return this.entry.title.length>17},titleDisplayHTML(){return this.isLongTitle?this.entry.title.substring(0,17)+'<span class="expander">…</span>':this.entry.title}}};const K=(0,z.Z)(q,[["render",U]]);var B=K,G={name:"SalesRank",data(){return{entries:[],history:[],sort_method:"date"}},props:{entry:Object},components:{RankEntry:B},async mounted(){let e=fetch(d+`latest.json?t=${(new Date).toISOString()}`),t=fetch(d+`history.json?t=${(new Date).toISOString()}`),r=await e;this.entries=await r.json(),this.SortEntries(),this.history=await(await t).json()},methods:{SortEntries(){const e=Q[this.sort_method];console.log(this.entries),this.entries.sort(e)}},computed:{}};const Q={date:(e,t)=>-e.recordDate.localeCompare(t.recordDate),sales:(e,t)=>t.salesValue-e.salesValue},X=(0,z.Z)(G,[["render",c]]);var ee=X,te={name:"App",components:{SalesRank:ee}};const re=(0,z.Z)(te,[["render",s]]);var ne=re;(0,n.ri)(ne).mount("#app")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.m=e,function(){var e=[];r.O=function(t,n,o,s){if(!n){var a=1/0;for(c=0;c<e.length;c++){n=e[c][0],o=e[c][1],s=e[c][2];for(var i=!0,l=0;l<n.length;l++)(!1&s||a>=s)&&Object.keys(r.O).every((function(e){return r.O[e](n[l])}))?n.splice(l--,1):(i=!1,s<a&&(a=s));if(i){e.splice(c--,1);var u=o();void 0!==u&&(t=u)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[n,o,s]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,s,a=n[0],i=n[1],l=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(o in i)r.o(i,o)&&(r.m[o]=i[o]);if(l)var c=l(r)}for(t&&t(n);u<a.length;u++)s=a[u],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(c)},n=self["webpackChunkbook_sales_info"]=self["webpackChunkbook_sales_info"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=r.O(void 0,[998],(function(){return r(8987)}));n=r.O(n)})();
//# sourceMappingURL=app.afdb2a55.js.map